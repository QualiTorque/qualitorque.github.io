<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-admin-guide/source-control/secret-manager-git-integration" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>AWS Secrets Manager for Git Integration | Torque</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://docs.qtorque.io/admin-guide/source-control/secret-manager-git-integration><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="AWS Secrets Manager for Git Integration | Torque"><meta data-rh=true name=description content=Overview><meta data-rh=true property=og:description content=Overview><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://docs.qtorque.io/admin-guide/source-control/secret-manager-git-integration><link data-rh=true rel=alternate href=https://docs.qtorque.io/admin-guide/source-control/secret-manager-git-integration hreflang=en><link data-rh=true rel=alternate href=https://docs.qtorque.io/admin-guide/source-control/secret-manager-git-integration hreflang=x-default><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://docs.qtorque.io/admin-guide/source-control/secret-manager-git-integration","name":"AWS Secrets Manager for Git Integration","position":1}]}</script><script src=https://cdn.cookielaw.org/consent/31859194-4ed7-4958-bfc5-08046e0f6ab7/OtAutoBlock.js type=text/javascript></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js charset=UTF-8 type=text/javascript data-domain-script=31859194-4ed7-4958-bfc5-08046e0f6ab7></script><script src=http://docs.qtorque.io/one-trust.js type=text/javascript></script><link rel=stylesheet href=/assets/css/styles.51ff6c39.css><script src=/assets/js/runtime~main.04cf56d2.js defer></script><script src=/assets/js/main.9f8b949f.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo.png alt=Torque class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/logo-dm.png alt=Torque class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/QualiTorque/torque-docs/discussions/categories/announcements target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-announcments-link"></a><a href=https://github.com/QualiTorque/torque-docs target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class=navbar__search-input value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/>Welcome!</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href="/overview/The Torque Terminology">🌴 Torque Overview</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href="/getting-started/Resources Inventory/Resources-Inventory">🚀 Getting Started</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/environment-services/drift-and-update>🔗 Environment Services</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href="/example-blueprints/Multi-Technology Orchestration">👀 Example Blueprints</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/blueprint-designer-guide/blueprint-quickstart-guide>📃 Blueprint Designer Guide</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/environment-as-code/environment-as-code-overview>☁ Environment As Code</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/workflows/workflows-overview>▶️ Workflows</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/governance/roles-and-permissions>🌍 Governance</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/admin-guide/configurations>⭐ Administration</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/configurations>Configurations</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/params>Parameters</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/input-sources>Input Sources</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/credentials>Credentials</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/notifications>Notifications</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/admin-guide/source-control/source-control-github>Repository Setup</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/source-control/source-control-github>GitHub Source Control</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/source-control/source-control-gitlab>GitLab Source Control</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/source-control/source-control-azure-repos>Azure Repos Source Control</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/source-control/source-control-bitbucket>BitBucket Source Control</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/source-control/source-control-codecommit>CodeCommit Source Control</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/source-control/source-managed-cloudshell>Self-Managed Quali CloudShell</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/admin-guide/source-control/secret-manager-git-integration>AWS Secrets Manager for Git Integration</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href="/admin-guide/source-control/Self Hosted Repositories/overview">Self Hosted Repositories</a></div></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/admin-guide/sso>SSO Configuration</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/eco-system/integrations-overview>🤝 Integrations</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/torque-agent/Torque-Agent-Intro>⚙ Self-Hosted Agent</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/reports/reports-overview>📊 Reports</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/rest-api>🖥 REST API</a><button aria-label="Expand sidebar category '🖥 REST API'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/privacy>🔐 Privacy</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/help/how-to-use-the-kb>🔎 Need Help?</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>⭐ Administration</span><li class=breadcrumbs__item><span class=breadcrumbs__link>Repository Setup</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>AWS Secrets Manager for Git Integration</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using AWS Secrets Manager for Git Repository Access</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=overview>Overview<a href=#overview class=hash-link aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>This guide explains how to use AWS Secrets Manager to manage and retrieve credentials for accessing a Git repository within the Torque platform. By using Secrets Manager, you can securely store and retrieve access tokens, which are then utilized by Torque's asset discovery (agent) and provisioning (runner) components, simplifying repository credential management while adhering to organizational security policies.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=scope>Scope<a href=#scope class=hash-link aria-label="Direct link to Scope" title="Direct link to Scope">​</a></h2>
<p>This guide supports the use of third-party secret management services, specifically AWS Secrets Manager, to retrieve repository tokens for use in the Torque platform. This provides a flexible and secure way to manage repository credentials during asset discovery and provisioning processes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=motivation>Motivation<a href=#motivation class=hash-link aria-label="Direct link to Motivation" title="Direct link to Motivation">​</a></h2>
<p>Integrating AWS Secrets Manager into Torque allows users to manage repository credentials in a more secure manner, facilitating seamless integration with Torque's asset discovery and provisioning capabilities. It enhances adaptability to customer policies on secrets storage and management, thus streamlining secure repository access within Torque.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=steps-to-configure-aws-secrets-manager-for-repository-access>Steps to Configure AWS Secrets Manager for Repository Access<a href=#steps-to-configure-aws-secrets-manager-for-repository-access class=hash-link aria-label="Direct link to Steps to Configure AWS Secrets Manager for Repository Access" title="Direct link to Steps to Configure AWS Secrets Manager for Repository Access">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=step-1-configure-the-secret-in-aws-secrets-manager>Step 1: Configure the Secret in AWS Secrets Manager<a href=#step-1-configure-the-secret-in-aws-secrets-manager class=hash-link aria-label="Direct link to Step 1: Configure the Secret in AWS Secrets Manager" title="Direct link to Step 1: Configure the Secret in AWS Secrets Manager">​</a></h3>
<ol>
<li><strong>Log in to your AWS Account</strong>: Navigate to the AWS Management Console and go to <strong>Secrets Manager</strong>.</li>
<li><strong>Create a New Secret</strong>: Click on <strong>Store a new secret</strong> and select the option to store an access token or any necessary repository credentials.</li>
<li><strong>Configure Secret Details</strong>: Provide a name for your secret, such as <code>git-repo-token</code>. Ensure that the secret name is descriptive and aligns with your organization's naming conventions.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=step-2-create-iam-role-with-required-permissions>Step 2: Create IAM Role with Required Permissions<a href=#step-2-create-iam-role-with-required-permissions class=hash-link aria-label="Direct link to Step 2: Create IAM Role with Required Permissions" title="Direct link to Step 2: Create IAM Role with Required Permissions">​</a></h3>
<ol>
<li><strong>Create IAM Role</strong>: In your AWS account, create an IAM role with the required permissions to access the secret stored in AWS Secrets Manager.<!-- -->
<ul>
<li><strong>Permission Policy</strong>: Attach the following permission policy to the IAM role to allow access to retrieve secrets:<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token property" style=color:#36acaa>"Version"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"2012-10-17"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token property" style=color:#36acaa>"Statement"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token property" style=color:#36acaa>"Sid"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SecretAccessPermission"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token property" style=color:#36acaa>"Effect"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Allow"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token property" style=color:#36acaa>"Action"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"secretsmanager:GetSecretValue"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token property" style=color:#36acaa>"Resource"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"*"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li><strong>Add Trust Relationship</strong>: Add a trust relationship policy to allow the Torque cluster to assume this role.<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token property" style=color:#36acaa>"Effect"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Allow"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token property" style=color:#36acaa>"Principal"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token property" style=color:#36acaa>"AWS"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"arn:aws:iam::046086677675:role/agent-sa-role"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token property" style=color:#36acaa>"Action"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sts:AssumeRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=step-3-configure-git-credentials-in-torque>Step 3: Configure Git Credentials in Torque<a href=#step-3-configure-git-credentials-in-torque class=hash-link aria-label="Direct link to Step 3: Configure Git Credentials in Torque" title="Direct link to Step 3: Configure Git Credentials in Torque">​</a></h3>
<ol>
<li><strong>Install the Agent</strong>: Ensure that the Torque agent is installed.</li>
<li><strong>Navigate to Torque Credentials</strong>: In the Torque portal, navigate to the <strong>Account Admin</strong> -> <strong>Credentials</strong> page.</li>
<li><strong>Add New Git Credential</strong>: Click on <strong>Add New Credential</strong> and select the credential type as <strong>Gitlab</strong>. In the dropdown list, choose the <strong>Secret Manager</strong> option.</li>
</ol>
<!-- -->
<blockquote>
<img src=/assets/images/git-secret-manager-8a6ac52f360ceeca1b0f4edb8963541e.png alt=git-secret-manager style=width:400px>
</blockquote>
<ol>
<li>
<p><strong>Fill Out Credential Details</strong>:</p>
<ul>
<li>Provide the <strong>Role ARN</strong> and <strong>External ID</strong> of the role created in Step 2.</li>
<li>The following fields are mandatory:<!-- -->
<ul>
<li><strong>Role ARN</strong>: The Amazon Resource Name (ARN) of the IAM role created in Step 2.</li>
<li><strong>Secret ID</strong>: The identifier for the secret in AWS Secrets Manager, which can be either the secret name or the secret ARN.</li>
<li><strong>Secret Path</strong>: Represents the hierarchy of fields inside the secret's value.</li>
</ul>
</li>
<li><strong>External ID</strong> is optional but can be provided if required by your security policies.</li>
</ul>
<p>The secret will be used by Torque's asset discovery (agent) or provisioning (runner) components to interact securely with the Git repository.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=troubleshooting>Troubleshooting<a href=#troubleshooting class=hash-link aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<ol>
<li>
<p><strong>Verify Secret Retrieval</strong>: You can manually verify that the secret can be retrieved using the AWS CLI or SDK to ensure proper configuration.</p>
<ul>
<li><strong>Using AWS CLI</strong>:<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">aws secretsmanager get-secret-value --secret-id git-repo-token</span><br></span></code></pre></div></div>
</li>
<li><strong>Using AWS SDK (Python Example)</strong>:<!-- -->
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> boto3</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">client </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> boto3</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">client</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'secretsmanager'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">response </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> client</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get_secret_value</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SecretId</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'git-repo-token'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">secret </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> response</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>'SecretString'</span><span class="token punctuation" style=color:#393A34>]</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p><strong>Git Clone Validation</strong>: Ensure that the retrieved token is being used correctly to access the Git repository. You can test this by running the following command:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token assign-left variable" style=color:#36acaa>GIT_TOKEN</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>aws secretsmanager get-secret-value --secret-id git-repo-token </span><span class="token variable parameter variable" style=color:#36acaa>--query</span><span class="token variable" style=color:#36acaa> SecretString </span><span class="token variable parameter variable" style=color:#36acaa>--output</span><span class="token variable" style=color:#36acaa> text</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>git</span><span class="token plain"> clone https://</span><span class="token variable" style=color:#36acaa>$GIT_TOKEN</span><span class="token plain">@github.com/your-org/your-repository.git</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=best-practices>Best Practices<a href=#best-practices class=hash-link aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<ul>
<li><strong>Regular Rotation</strong>: Regularly rotate the secrets in AWS Secrets Manager to minimize security risks.</li>
<li><strong>Access Control</strong>: Use AWS Identity and Access Management (IAM) to restrict access to the secret, ensuring only authorized users or services can retrieve it.</li>
<li><strong>Audit and Monitoring</strong>: Enable AWS CloudTrail to monitor access to your secrets and ensure compliance with your organization’s security policies.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=summary>Summary<a href=#summary class=hash-link aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>By utilizing AWS Secrets Manager, you can securely store and manage Git repository credentials for use within the Torque platform, improving the security and compliance of your asset discovery and provisioning workflows. Follow the above steps to integrate Secrets Manager seamlessly with your Git operations in Torque.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/QualiTorque/torque-docs/tree/master/docs/admin-guide/source-control/secret-manager-git-integration.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/admin-guide/source-control/source-managed-cloudshell><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Self-Managed Quali CloudShell</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/admin-guide/source-control/Self Hosted Repositories/overview"><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Using Self-Managed source control providers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#overview class="table-of-contents__link toc-highlight">Overview</a><li><a href=#scope class="table-of-contents__link toc-highlight">Scope</a><li><a href=#motivation class="table-of-contents__link toc-highlight">Motivation</a><li><a href=#steps-to-configure-aws-secrets-manager-for-repository-access class="table-of-contents__link toc-highlight">Steps to Configure AWS Secrets Manager for Repository Access</a><ul><li><a href=#step-1-configure-the-secret-in-aws-secrets-manager class="table-of-contents__link toc-highlight">Step 1: Configure the Secret in AWS Secrets Manager</a><li><a href=#step-2-create-iam-role-with-required-permissions class="table-of-contents__link toc-highlight">Step 2: Create IAM Role with Required Permissions</a><li><a href=#step-3-configure-git-credentials-in-torque class="table-of-contents__link toc-highlight">Step 3: Configure Git Credentials in Torque</a></ul><li><a href=#troubleshooting class="table-of-contents__link toc-highlight">Troubleshooting</a><li><a href=#best-practices class="table-of-contents__link toc-highlight">Best Practices</a><li><a href=#summary class="table-of-contents__link toc-highlight">Summary</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Company</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.quali.com/ target=_blank rel="noopener noreferrer" class=footer__link-item>Quali Website<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://www.quali.com/careers/ target=_blank rel="noopener noreferrer" class=footer__link-item>Careers<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/QualiTorque/torque-docs/discussions target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub Community<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://twitter.com/qualisystems target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.quali.com/blog/ target=_blank rel="noopener noreferrer" class=footer__link-item>Quali blog<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/QualiTorque/torque-docs target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div></div></footer></div>