<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blueprint-designer-guide/blueprints">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<title data-rh="true">Blueprint YAML | Torque</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/blueprint-designer-guide/blueprints"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Blueprint YAML | Torque"><meta data-rh="true" name="description" content="Torque blueprints are reusable components designed to model a required environment from the infrastructure to the application. Blueprint designers utilize Torque&#x27;s VSCode plugin or the Torque&#x27;s self-service UI to build a YAML based imperative blueprints that aimed to fulfill business requirements in a self-service manner for their end-users."><meta data-rh="true" property="og:description" content="Torque blueprints are reusable components designed to model a required environment from the infrastructure to the application. Blueprint designers utilize Torque&#x27;s VSCode plugin or the Torque&#x27;s self-service UI to build a YAML based imperative blueprints that aimed to fulfill business requirements in a self-service manner for their end-users."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/blueprint-designer-guide/blueprints"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/blueprint-designer-guide/blueprints" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/blueprint-designer-guide/blueprints" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.97490da5.css">
<link rel="preload" href="/assets/js/runtime~main.a453e321.js" as="script">
<link rel="preload" href="/assets/js/main.6faeb22a.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/QualiTorque/torque-docs/discussions/categories/announcements" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-announcments-link"></a><a href="https://github.com/QualiTorque/torque-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="torque-brand"></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h2>Documentation</h2></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome to Torque!</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/getting-started/The Torque Terminology">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blueprint-designer-guide/blueprint-quickstart-guide">Blueprint Designer Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blueprint-designer-guide/blueprint-quickstart-guide">Blueprint Quickstart Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blueprint-designer-guide/Autogenerated Blueprints">Autogenerated Blueprints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blueprint-designer-guide/customize-blueprints">Customizing Autogenerated Blueprints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blueprint-designer-guide/blueprints">Blueprint YAML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blueprint-designer-guide/service-accounts-for-aws">Terraform Authentication on EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blueprint-designer-guide/service-accounts-for-azure">Terraform Authentication on AKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blueprint-designer-guide/Policies">Blueprint Policies</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/admin-guide/roles-and-permissions">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/deployment-architecture/Architecture">Deployment Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/eco-system/integrations-overview">Integrations</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Blueprint Designer Guide</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Blueprint YAML</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Blueprint YAML</h1></header><p>Torque blueprints are reusable components designed to model a required environment from the infrastructure to the application. <strong>Blueprint designers</strong> utilize Torque&#x27;s VSCode plugin or the Torque&#x27;s self-service UI to build a YAML based imperative blueprints that aimed to fulfill business requirements in a self-service manner for their end-users. </p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>Note</strong></h5></div><div class="admonition-content"><p>Blueprints are written in YAML files that reside in a <strong>/blueprints</strong> folder within a Github, Gitlab or BitBucket repository (the folder name is case-sensitive and must be &quot;blueprints&quot;). The <strong>/blueprints</strong> folder must be defined as the blueprint repository in the space&#x27;s <strong>Settings &gt; Repositories</strong> page. Blueprints file type must be &quot;.yaml&quot; and not &quot;.yml&quot;.</p></div></div><p>Common example will be a platform team or a DevOps team building Dev, Test and staging environments for their development, QA and product teams. With Torque, the DevOps team can focus on design, best practices, and security for environment, while their end users are being self-served from the torque UI, API or eco-system integrations based on governance and policies without having the &#x27;keys-to-the-cloud&#x27;.</p><p>In this article:</p><ul><li><a href="#torques-blueprint-yaml">Torque&#x27;s Blueprint YAML</a></li><li><a href="#the-terraform-grain">The Terraform Grain</a></li><li><a href="#the-helm-grain">The HELM Grain</a></li><li><a href="#the-cloudformation-grain">The CloudFormation Grain​</a></li><li><a href="#the-kubernetes-grain">The Kubernetes Grain​</a></li><li><a href="#the-shell-grain">The Shell Grain</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="torques-blueprint-yaml">Torque&#x27;s Blueprint YAML<a class="hash-link" href="#torques-blueprint-yaml" title="Direct link to heading">​</a></h2><p>The Torque&#x27;s blueprint YAML is the main bluperint definition file. It contains general information about the environment as well as the grains that make up the environment&#x27;s applications and services. The blueprint YAML is published to end-users in Torque&#x27;s blueprint catalog. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="spec_version">spec_version<a class="hash-link" href="#spec_version" title="Direct link to heading">​</a></h3><p>The spec_version determines the blueprint YAML type. Currently, Torque supports spec_version:2 as the default and recommended version. With time, new preview releases and official feature releases will bring more and more features and users will be able to use other spec versions.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spec_version: 2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="description">Description<a class="hash-link" href="#description" title="Direct link to heading">​</a></h3><p>The blueprint’s description is an optional but recommended field. Blueprint description will be presented in the Torque&#x27;s UI and API so users consuming environment will have more information about the blueprints to batter match their business need to the available set of blueprints published in the account catalog.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spec_version: 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">description: Performance testing deployment based on RDS, EKS and Lambda</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="inputs">Inputs<a class="hash-link" href="#inputs" title="Direct link to heading">​</a></h3><p>Blueprint designers can publish blueprint inputs to their end-users to add flexibility while launching a new environment from the blueprints, without altering the blueprint code itself. Input data can be later used in the blueprint to control orchestration, pass information to automation processes, and more.</p><p>The input definition is composed out of the following fields: </p><ul><li>The input name</li><li><code>description</code> is presented to all users in the Torque UI and API&#x27;s (Optional)</li><li><code>type</code> of the input. Options are:<ul><li><code>string</code></li><li><code>execution-host</code> allows the environment end-user to select the execution host that will deploy the grain(s) from a dropdown list. By default, all execution hosts are listed in the dropdown list, but you can add <code>allowed-values</code> to only display a subset of the execution hosts. For details, see <a href="#host">host</a>.</li></ul></li><li><code>sensitive</code>: <code>true</code> masks the value behind asterisks in the UI and API. (Default is <code>false</code>) </li><li><code>default</code> - (Optional) Value to be used in the Torque UI and will be used in case no other value provided for the input. If a default value is not defined, the environment end-user will need to provide one when launching the environment.</li><li><code>allowed-values</code> converts the input into a dropdown list, allowing the environment end-user to select the appropriate value. If a <code>default</code> is specified, it must be included in the allowed values list. </li></ul><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  app_version:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    type: string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    allowed-values: [0.9.7, 0.9.8, 0.9.9]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    default: &quot;0.9.9&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    description: &quot;The version of the application to be deployed on the EKS cluster&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    type: execution-host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    allowed-values [NY, Tokyo, London]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    description: &quot;Select your site&#x27;s host.&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="outputs">Outputs<a class="hash-link" href="#outputs" title="Direct link to heading">​</a></h3><p>Outputs exposes information about your newly deployed environment and make it available for the environment&#x27;s end-user or automation processes. Outputs will usually be available at the end of the environment&#x27;s initialization and accessible throughout the environment lifecycle.</p><p>Outputs are a dictionary composed by the output name and the output value.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  WebsiteUrl:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value: &#x27;application-name-{{ sandboxid | downcase }}.testquali.click:8080&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: link</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DB_Hostname:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value: &#x27;{{ .grains.mySqlDB.outputs.hostname }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The example above includes some of the Torque&#x27;s YAML templating engine capabilities allowing the blueprint designer more flexibility and leads to less code that will require maintenance. More examples for templating will be described <a href="/blueprint-designer-guide/blueprints#torque-templating-engine">Torque Templating engine</a>.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="grains">Grains<a class="hash-link" href="#grains" title="Direct link to heading">​</a></h3><p>Grains are the basic building blocks of a blueprint utilizing infrastructure as code (IaC) assets or automation processes to orchestrate the desired environment. In many organization, the blueprint designers will have a predefined set of grains they can use in blueprints provided by the IT/Ops/DevOps or platform team. </p><p>The basic grain template is composed out of the grain name, kind, inputs and output. specific grains might support other features that are technology specific.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grain_name:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: &lt;path to repository&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: &#x27;{{ .inputs.host_name }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input1: &#x27;{{ .inputs.value1 }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input1: &#x27;{{ .inputs.value2 }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - output1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - output2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Note that in auto-generated blueprints, the <strong>grain_name.spec.host.name</strong> is automatically published as a blueprint input, which the blueprint designer can use. As a best practice, it&#x27;s recommended to remove the <strong>host.name</strong> input once the blueprint is published to the catalog.</p></div></div><p>The following grains are available:</p><ul><li><a href="#the-terraform-grain">Terraform</a></li><li><a href="#the-helm-grain">Helm</a></li><li><a href="#the-cloudformation-grain">CloudFormation</a></li><li><a href="#the-kubernetes-grain">Kubernetes</a></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="source">Source<a class="hash-link" href="#source" title="Direct link to heading">​</a></h3><p>Sources are repositories storing IaC, CM or other configuration technology that will be utilized by Torque to launch and operate an environment. Torque supports multiple ways to define grain sources.
Sources can be defined in the following ways:</p><p><strong>1) Direct link to a source control folder</strong>: Composed from the repository URL followed by the folder structure leading to the folder where IaC code resides. For example:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aurora:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      path: github.com/organization/repository.git//folder1/folder2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>2) location based on a repository (blueprints or assets) onboarded to Torque</strong>: The name of the repository should be provided under the &#x27;store&#x27; field, while the IaC code folder location should be specified under the path field. In the below example, nginx helm chart resides in the &#x27;nginx&#x27; folder within a repository onboarded to Torque with the name &#x27;web_servers&#x27;.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  nginx:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: helm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        store: web_servers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: nginx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>In case your IaC code is not under folder in the repository, the path should be set as in the following example:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        store: web_servers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: .</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="host">Host<a class="hash-link" href="#host" title="Direct link to heading">​</a></h3><p>Hosts, or <strong>Execution Hosts</strong> are the locations where grains will be deployed from. While different grains behave differently, it&#x27;s important to choose the right execution host for a grain to make sure authentication, networking and configuration is all properly configured. Different grains in the same blueprint can use different Execution Hosts to allow maximum flexibility during the orchestration processes.</p><p>You can specify the execution host in two ways:</p><ul><li>Literally. For example:<div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># launch an RDS instance using Terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rds:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      name: my-execution-host</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li>Using an execution-host input, which allows the environment end-user to select the execution host to use from a dropdown list. For details, see the <a href="#inputs">blueprint yaml&#x27;s inputs</a> section.<div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># launch an RDS instance using Terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rds:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      name: &#x27;{{ inputs.my_execution_host }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Execution hosts gives the flexibility of deploying the same blueprints over different cloud accounts and cloud vendors. For example, the same blueprint can be utilized for Azure or GCP simply by exposing the host as a blueprint input, from which the end-user to choose his preferred cloud provider, each represented with a different execution host.</p></div></div><p>The Execution host configuration must include:</p><ul><li><strong>name</strong> - the given name for the kubernetes cluster configured under the cloud account area where the grain will be executed.</li><li><strong>service-account</strong> - The service-account name configured within the kubernetes cluster that will be used to execute the grain. A kubernetes service account provides an identity for processes that run in a pod. </li></ul><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # launch an RDS instance using Terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rds:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: eks-ohio</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        service-account: torque-sa</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="grain-inputs--outputs">Grain inputs &amp; outputs<a class="hash-link" href="#grain-inputs--outputs" title="Direct link to heading">​</a></h3><p>Inputs and outputs are used both in the blueprint level and in the grains level. Grains can use inputs and outputs to pass data between IaC components, validate information and eventually lead to reducing the amount of IaC components that needs to be maintained by the organization.</p><p>In the below example, a Terraform deployment generates a connection string to a managed database that can then be utilized by the application itself using the ability to pass output from one grain as a input to the other.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # launch an RDS instance using Terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rds:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - connection_string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  my_app_demo:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # Launcing k8s based microservices application using HELM</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: helm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    depends-on: rds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - connectionString: &#x27;{{ .grains.rds.outputs.connection_string }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="grain-dependencies">Grain dependencies<a class="hash-link" href="#grain-dependencies" title="Direct link to heading">​</a></h3><p>The need to deploy one IaC component before the other is common and usually required when 3rd party components, managed services and other teams need to provide the infrastructure. Using dependencies in the blueprint YAML Torque will evaluate and optimize the deployment process to make sure dependencies are respected and components with no dependencies will be deployed in parallel to maximize efficiency and reduce overall uptime.</p><p>In the example below, 3 grain in the bluerpint will be deployed in the following order: rds and redis will be deployed in parallel - and my_app will be deployed next, only in case of a successful deployment.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # launch an RDS instance using Terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rds:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # launch an ElastiCache </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  redis:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  my_app_demo:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # Launcing k8s based microservices application using HELM</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: helm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    depends-on: rds, redis</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The ability to use outputs from specific grain usually requires the grain deployment to finish successfully. designing a blueprint with output usually requires dependencies between the grains.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="torque-templating-engine">Torque Templating engine<a class="hash-link" href="#torque-templating-engine" title="Direct link to heading">​</a></h3><p>Templating engines are a great way to enrich the YAML format to allow extensibility points and text manipulations. Torque utilized Shopify&#x27;s <a href="https://shopify.github.io/liquid/" target="_blank" rel="noopener noreferrer">liquid</a> engine to allow multiple text manipulations in runtime.</p><p>In the below example the <a href="https://shopify.github.io/liquid/filters/downcase/" target="_blank" rel="noopener noreferrer">downcase</a> and <a href="https://shopify.github.io/liquid/filters/strip/" target="_blank" rel="noopener noreferrer">strip</a> keywords are used with concatenation of the sandbox id to create a new S3 bucket (AWS) using Terraform while making sure the bucket name will be valid and unique.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  s3_bucket:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: s3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: &#x27;{{ .inputs.host_name }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - bucket_name: &#x27;{{ .inputs.bucket_name | strip }}-bucket-{{ sandboxid | downcase }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Blueprint designers might need extra details about the account, space or environment during the environment&#x27;s orchestration. Torque provides dynamic attributes such as a sandboxid, accountid and spaceid that can be used through the orchestration and automation process.   </p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">​</a></h3><p>Torque&#x27;s <a href="/admin-guide/params">Parameters</a> store allows admins to set pre-defined account/space-level parameters. Blueprint designers can use the parameters in the blueprint YAML, instead of inputs if they don&#x27;t want the environment end-user to provide the value, but also don&#x27;t want to hard-code it in the blueprint.</p><p>The syntax is: <code>{{.params.param-value}}</code></p><p>The syntax is the same for both account and space level parameters. A space-level parameter will take precedence over an account-level parameter with the same name.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  s3_bucket:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: s3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: &#x27;{{ .inputs.host_name }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - bucket_name: &#x27;{{ .params.my-bucket }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="environment-variables">Environment Variables<a class="hash-link" href="#environment-variables" title="Direct link to heading">​</a></h3><p>In many cases, passing information through environment variables is required for IaC modules to properly execute with the right data in mind. The environment variables provided under a specific grain will be accessible only during the grain lifecycle of the specific grain and can be used as a specific string or to be derived from a blueprint input or other grain output. </p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  s3_bucket:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      env-vars:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      - VAR_NAME1: value1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      - VAR_NAME2: &#x27;{{ .inputs.input_name }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      - VAR_NAME3: &#x27;{{ .grains.vm.outputs.host_name }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-terraform-grain">The Terraform Grain<a class="hash-link" href="#the-terraform-grain" title="Direct link to heading">​</a></h2><p>The Terraform grain is Torque&#x27;s native support for HashiCorp Terraform modules. Torque allows designers to use Terraform specific features to easily orchestrate self-developer and community Terraform modules in a standard way and share them with others as building blocks. Note that to deploy Terraform modules, you will need to authenticate Terraform on the Kubernetes cluster. For details, see <a href="/blueprint-designer-guide/service-accounts-for-aws">Terraform Authentication on EKS</a> or <a href="/blueprint-designer-guide/service-accounts-for-azure">Terraform Authentication on AKS</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="source-1">source<a class="hash-link" href="#source-1" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#source">the grain source</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="host-1">host<a class="hash-link" href="#host-1" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#host">the grain host</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="tf-version">tf-version<a class="hash-link" href="#tf-version" title="Direct link to heading">​</a></h3><p>Torque provides the flexibility to choose a specific Terraform version with which the Terraform module will be deployed (minimum supported version is 0.14).</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Note that Torque supports all Terraform versions available by Hashicorp without Alpha and Beta versions.
List of supported releases can be found <a href="https://releases.hashicorp.com/terraform/" target="_blank" rel="noopener noreferrer">here</a></p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="inputs-1">inputs<a class="hash-link" href="#inputs-1" title="Direct link to heading">​</a></h3><p>Similar to blueprint inputs, the Terraform grain input allows you to reuse the same Terraform module in different ways. Inputs provided to the Terraform grain are used when launching the Terraform module. Terraform grain inputs should be listed in the order defined in the module&#x27;s variables.tf file. We recommend using Torque&#x27;s auto-discovery capability to quickly model your Terraform modules within Torque including all defined inputs.</p><p>Every value that goes to the Terraform grain&#x27;s input is interpreted as a json token. So you can pass any valid value by json: number, list, dictionary, boolean, string , etc.
For details, check out this Terraform Docs section <a href="https://www.terraform.io/language/values/variables#variable-definitions-tfvars-files" target="_blank" rel="noopener noreferrer">Variable Definitions (.tfvars) Files</a></p><p>Example:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  database:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        store: infra </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: terraform/rds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - database_size: &#x27;{{ .inputs.db_size }}&#x27; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - database_name: &#x27;{{ .inputs.db_name }}&#x27; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input_number: 6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input_string: &#x27;{&quot; this is my input string &quot;}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input_list_strings: &#x27;[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input_map_strings: &#x27;{ &quot;key1&quot;:&quot;val1&quot;, &quot;key2&quot;:&quot;val2&quot; }&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - input_object: &#x27;{ &quot;key1&quot;:val1, &quot;key2&quot;:4 }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Note that in the above example, some blueprint inputs are used as the values of the Terraform grain inputs, so the environment&#x27;s owner is able to choose the db_size and db_name required for his need. The information provided by the user will be passed to Terraform and affect the deployment process. The blueprint input type is always &quot;string&quot;. the actual parsing of the json type will be done automatically.</p></div></div><p>Note that invalid tokens will be parsed as strings. Keep in mind that json strings require double quotes, so <code>&quot;my value</code> is a string but <code>my value</code> is not a valid json value and therefore will also be passed as a string. As such, the following values will all be passed as strings: <code>&quot;my value&quot;</code>, <code>my value</code>, <code>&quot;[1,2,3]&quot;</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="tags">tags<a class="hash-link" href="#tags" title="Direct link to heading">​</a></h3><p>Whenever a Terraform grain is launched, all resources created during the deployment process will be automatically tagged with Torque&#x27;s system tags, built-in tags and custom tags (for details, see <a href="/admin-guide/tags">Tags</a>. if you wish to disable tagging for all resources in a specific Terraform grain, use the following syntax:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  database:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      tags:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        auto-tag: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="outputs-1">outputs<a class="hash-link" href="#outputs-1" title="Direct link to heading">​</a></h3><p>Output are values generated by Terraform during the deployment process. Outputs should be defined in the outputs.tf file located in the Terraform module folder. We recommend using Torque&#x27;s auto-discovery capability to quickly model your Terraform modules within Torque including it&#x27;s defined outputs.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  database:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: github.com/org/repo.git//terraform/rds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - hostname</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - connection_string</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="scripts">scripts<a class="hash-link" href="#scripts" title="Direct link to heading">​</a></h3><p>Torque provides the ability to execute custom code before the executing the Terraform module init and before the Terraform destroy process. Scripts allows to run CLI commands to make sure authentication and requirements are set prior to the Terraform execution at the environment&#x27;s initialization and destroy process.
In the below example, authentication script is used to assume role to another AWS account prior to deploying workload into that account.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  amazon_emr:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: terraform</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        store: tf-repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      scripts: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pre-tf-init:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            store: tf-repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            path : scripts/authenticate.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          arguments: &#x27;{{.inputs.ACCOUNT_ID}}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pre-tf-destroy:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            store: tf-repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            path : scripts/authenticate.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          arguments: &#x27;{{.inputs.ACCOUNT_ID}}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Note that scripts should be stored next to your IaC code to be used under the scripts section.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-helm-grain">The HELM Grain<a class="hash-link" href="#the-helm-grain" title="Direct link to heading">​</a></h2><p>The HELM grain is Torque&#x27;s native support for HELM v3 charts. Torque allows designers to use HELM specific features to easily orchestrate self-developer and community charts in a standard way and share them with others as building blocks.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="source-2">source<a class="hash-link" href="#source-2" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#source">the grain source</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="host-2">host<a class="hash-link" href="#host-2" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#host">the grain host</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="inputs-2">inputs<a class="hash-link" href="#inputs-2" title="Direct link to heading">​</a></h3><p>Similar to blueprint inputs and Terraform inputs, the HELM grain inputs allow you to reuse the same HELM chart in different ways using different values overrides. Inputs provided to the HELM grain are used when launching the HELM chart. We recommend using Torque&#x27;s auto-discovery capability to quickly model your HELM chart within Torque including all defined inputs.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  nginx:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: helm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: https://github.com/bitnami/charts.git//bitnami/nginx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - replicaCount: &#x27;{{ .inputs.replicaCount }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Note that in the above example, blueprint input is used as the value of the HELM grain input, so the environment&#x27;s owner is able to choose the replicaCount required for his need. The information provided by the user will be passed to HELM chart as values and affect the deployment process.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="outputs-2">outputs<a class="hash-link" href="#outputs-2" title="Direct link to heading">​</a></h3><p>Helm does not natively expose outputs. However, this can be done using a <code>post-helm-install</code> script that assigns environment variables after the grain&#x27;s deployment. The script must be referenced, along with the names of the environment variables in the grain&#x27;s <a href="#scripts-1">scripts</a>. To expose the outputs to the environment, the names of the environment variables must be referenced in the blueprint&#x27;s <code>outputs</code> section.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>tip</strong></h5></div><div class="admonition-content"><p>For illustration purposes, here&#x27;s a <a href="https://github.com/orel-h/test-spec2-public/blob/master/blueprints/helm-outputs-demo.yaml" target="_blank" rel="noopener noreferrer">Helm chart</a> that declares a <strong>URL</strong> environment variable and references the <a href="https://github.com/orel-h/test-spec2-public/blob/master/scripts/orel_helm_script_args_demo.sh" target="_blank" rel="noopener noreferrer">post-install script</a> that publishes that environment variable as an output.</p></div></div><p>For example:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spec_version: 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">description: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  output1:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: regular</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value: &#x27;{{.grains.&lt;grain name&gt;.scripts.post-helm-install.outputs.&lt;output name&gt;}}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  output2:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: regular</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value: &#x27;{{.grains.&lt;grain name&gt;.scripts.post-helm-install.outputs.&lt;output name&gt;}}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="commands">commands<a class="hash-link" href="#commands" title="Direct link to heading">​</a></h3><p>The commands section allows to execute CLI code prior to the HELM chart deployment to make sure all dependencies are met to ensure a successful deployment. Common use for commands is to execute HELM dependencies update to collect all the sub-charts required for the deployment.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  nginx:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: helm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: https://github.com/bitnami/charts.git//bitnami/nginx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: aws-demo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - replicaCount: &#x27;{{ .inputs.replicaCount }}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - dep up bitnami/nginx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="scripts-1">scripts<a class="hash-link" href="#scripts-1" title="Direct link to heading">​</a></h3><p>Torque provides the ability to execute custom code after Torque executes the Helm chart. This is useful for generating and using outputs, as explained in <a href="#outputs-2">helm outputs</a>.</p><p>For example - grain with a post-install script and outputs &quot;test1&quot; and &quot;test2&quot;:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  nginx:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: helm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        service-account: ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - replicaCount: ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - dep up bitnami/nginx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      scripts:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        post-helm-install:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          source:  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            path: github.com/steve/my-public.git//scripts/helm_script.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - test1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - test2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-cloudformation-grain">The CloudFormation Grain​<a class="hash-link" href="#the-cloudformation-grain" title="Direct link to heading">​</a></h2><p>The CloudFormation grain is Torque&#x27;s native support for AWS CloudFormation templates. Torque allows designers to use CloudFormation features to easily orchestrate self-developer and community CloudFormation modules in a standard way and share them with others as building blocks.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="source-3">source<a class="hash-link" href="#source-3" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#source">the grain source</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="host-3">host<a class="hash-link" href="#host-3" title="Direct link to heading">​</a></h3><p>Host is not required or supported by CloudFormation Grain. Instead, this grain uses direct authentication to the AWS cloud account, as explained below.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="authentication">authentication<a class="hash-link" href="#authentication" title="Direct link to heading">​</a></h3><p>To enable Torque to connect to the AWS account and deploy the CloudFormation template, you must supply the following details in the CloudFormation grain&#x27;s authentication section:</p><ul><li><strong>role-arn</strong>: ARN Role with the permission to deploy CloudFormation Template on the AWS Account </li><li><strong>external-id</strong> of the AWS Cloud Account </li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>Note</strong>:</h5></div><div class="admonition-content"><p>As a best practice, we recommend the following:</p><ul><li>Have the account admin set parameters containing the required authentication values in the <a href="/admin-guide/params">Parameter Store</a>.</li><li>As the blueprint designer, supply the parameters from the Parameter Store in the CloudFormation Grain <code>authentication</code> section.</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="inputs-3">inputs​<a class="hash-link" href="#inputs-3" title="Direct link to heading">​</a></h3><p>Similar to blueprint inputs, CloudFormation grain inputs allow you to reuse the same CloudFormation module in different ways. Inputs provided to the CloudFormation grain are used when launching the CloudFormation module.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="tags-1">tags​<a class="hash-link" href="#tags-1" title="Direct link to heading">​</a></h3><p>Whenever a CloudFormation grain is launched, all resources created during the deployment process are automatically tagged with Torque&#x27;s system tags, built-in tags and custom tags.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="outputs-3">outputs​<a class="hash-link" href="#outputs-3" title="Direct link to heading">​</a></h3><p>Outputs are strings generated by CloudFormation during the deployment process.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  database:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: cloudformation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path: github.com/org/repo.git//cloudformation/rds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      authentication:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        role-arn:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        external-id:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - hostname</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - connection_string</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-kubernetes-grain">The Kubernetes Grain​<a class="hash-link" href="#the-kubernetes-grain" title="Direct link to heading">​</a></h2><p>The Kubernetes grain allows you to use native Kubernetes manifests, manifest catalogs in a given user&#x27;s repository. Currently, it is not possible to launch multiple concurrent environments from the same blueprint on the same namespace (because the manifest resources are static and their names are not unique).</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="source-4">source<a class="hash-link" href="#source-4" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#source">the grain source</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="host-4">host<a class="hash-link" href="#host-4" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#host">the grain host</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="tags-2">tags​<a class="hash-link" href="#tags-2" title="Direct link to heading">​</a></h3><p>Whenever a Kubernetes grain is launched, all resources created during the deployment process are automatically tagged with Torque&#x27;s system tags, built-in tags and custom tags. If you wish to disable tagging for all resources in a specific Kubernetes grain, use the following syntax:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  database:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: kubernetes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      tags:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        auto-tag: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="namespace">namespace<a class="hash-link" href="#namespace" title="Direct link to heading">​</a></h3><p>The deployment namespace must exist in the cluster prior to the deployment. It must not be equal to the namespaces used by Torque for agent deployments.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  web-client:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: kubernetes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sources:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      namespace: &#x27;{{ .inputs.namespace }}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>Note</strong>:</h5></div><div class="admonition-content"><ul><li>Launching concurrent environments with a Kubernetes grain is not supported for the same namespace. </li><li>Make sure the Torque execution host has permissions to use those namespaces.</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="scripts-outputs">scripts (outputs)<a class="hash-link" href="#scripts-outputs" title="Direct link to heading">​</a></h3><p>Kubernetes does not natively support outputs. Using Torque, you can overcome this and provide outputs from the manifest installation process using scripts. In this approach, the script must export environment variables. These environment variables can later be declared also as outputs.
The script is defined in the blueprint and executed after the grain&#x27;s installation.</p><p>For example, script named <strong>post-install-script.sh</strong> that generates two outputs:</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  output1:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: regular</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value: &#x27;{{.grains.nginx.scripts.post-kubernetes-install.outputs.output1}}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  output2:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: regular</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value: &#x27;{{.grains.nginx.scripts.post-kubernetes-install.outputs.output2}}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  nginx:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: kubernetes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      namespace:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      scripts:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        post-kubernetes-install:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          source:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            store: Torque-Spec2-Demos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            path: scripts/post-install-script.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          outputs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - output1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - output2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-shell-grain">The Shell Grain<a class="hash-link" href="#the-shell-grain" title="Direct link to heading">​</a></h2><p>The Shell grain is an asset-agnostic grain that allows you to run bash/python3 commands as part of your environment’s launch and/or teardown. It’s useful if you need to prepare or clean up your environment’s cloud infrastructure as part of the deployment. For example, you could use this grain to run &quot;datree&quot; validations on a Kubernetes grain’s asset, or perhaps back up/clone a DB before environment deployment.</p><div class="codeBlockContainer_I0IT language-yaml” theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml” codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  validate:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: …</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      activities:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        deploy:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - …</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        destroy:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - …</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="host-5">host<a class="hash-link" href="#host-5" title="Direct link to heading">​</a></h3><p>Please see <a href="/blueprint-designer-guide/blueprints#host">the grain host</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="inputs-4">inputs<a class="hash-link" href="#inputs-4" title="Direct link to heading">​</a></h3><p>Similar to blueprint inputs, inputs provided to the Shell grain are used when launching the shell. Unlike other grains, in the Shell grain, inputs are used inside the <strong>commands</strong> section, wrapped in double curly brackets - <code>&quot; {{ .inputs.input1 }}&quot;</code>.</p><div class="codeBlockContainer_I0IT language-yaml&quot; theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml&quot; codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  validate:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: kubernetes-testing1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      activities:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        deploy:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;{{ .inputs.repoURL }}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;git clone {{ .inputs.repoUrl }}&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="commands-1">commands<a class="hash-link" href="#commands-1" title="Direct link to heading">​</a></h3><p>The commands section allows to execute bash/python3 code as part of the launch and/or end of the environment. The Shell grain has two command types - <strong>deploy</strong> for running code at the launch of the environment, and <strong>destroy</strong> for running code as part of the environment’s teardown. </p><div class="codeBlockContainer_I0IT language-yaml” theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-yaml” codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">grains:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  validate:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kind: shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name: kubernetes-testing1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      activities:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        deploy:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;apt-get -y install git unzip curl&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;git clone {{ .inputs.repoUrl }}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;curl https://get.datree.io | /bin/bash&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;datree test {{.inputs.repoName}}/{{.inputs.filePath}}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        destroy:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          commands:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;https://gist.githubusercontent.com/.../check.py&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - &quot;python3 check.py&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>note</strong></h5></div><div class="admonition-content"><p>You can specify the code to be run as freetext bash/python3 commands or by referencing a bash/python3 file:</p><div class="codeBlockContainer_I0IT language-jsx theme-code-block"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_BvAR">Python 3 example:</div><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-jsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">commands</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;apt-get -y install wget&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;wget https://.../check.py&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;python3 check.py&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-jsx theme-code-block"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_BvAR">Bash example:</div><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-jsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">commands</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;apt-get -y install wget&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;wget https://.../simple.sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/bash simple.sh&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/QualiTorque/torque-docs/tree/master/docs/blueprint-designer-guide/blueprints.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blueprint-designer-guide/customize-blueprints"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Customizing Autogenerated Blueprints</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blueprint-designer-guide/service-accounts-for-aws"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Terraform Authentication on EKS</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#torques-blueprint-yaml" class="table-of-contents__link toc-highlight">Torque&#39;s Blueprint YAML</a><ul><li><a href="#spec_version" class="table-of-contents__link toc-highlight">spec_version</a></li><li><a href="#description" class="table-of-contents__link toc-highlight">Description</a></li><li><a href="#inputs" class="table-of-contents__link toc-highlight">Inputs</a></li><li><a href="#outputs" class="table-of-contents__link toc-highlight">Outputs</a></li><li><a href="#grains" class="table-of-contents__link toc-highlight">Grains</a></li><li><a href="#source" class="table-of-contents__link toc-highlight">Source</a></li><li><a href="#host" class="table-of-contents__link toc-highlight">Host</a></li><li><a href="#grain-inputs--outputs" class="table-of-contents__link toc-highlight">Grain inputs &amp; outputs</a></li><li><a href="#grain-dependencies" class="table-of-contents__link toc-highlight">Grain dependencies</a></li><li><a href="#torque-templating-engine" class="table-of-contents__link toc-highlight">Torque Templating engine</a></li><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a></li><li><a href="#environment-variables" class="table-of-contents__link toc-highlight">Environment Variables</a></li></ul></li><li><a href="#the-terraform-grain" class="table-of-contents__link toc-highlight">The Terraform Grain</a><ul><li><a href="#source-1" class="table-of-contents__link toc-highlight">source</a></li><li><a href="#host-1" class="table-of-contents__link toc-highlight">host</a></li><li><a href="#tf-version" class="table-of-contents__link toc-highlight">tf-version</a></li><li><a href="#inputs-1" class="table-of-contents__link toc-highlight">inputs</a></li><li><a href="#tags" class="table-of-contents__link toc-highlight">tags</a></li><li><a href="#outputs-1" class="table-of-contents__link toc-highlight">outputs</a></li><li><a href="#scripts" class="table-of-contents__link toc-highlight">scripts</a></li></ul></li><li><a href="#the-helm-grain" class="table-of-contents__link toc-highlight">The HELM Grain</a><ul><li><a href="#source-2" class="table-of-contents__link toc-highlight">source</a></li><li><a href="#host-2" class="table-of-contents__link toc-highlight">host</a></li><li><a href="#inputs-2" class="table-of-contents__link toc-highlight">inputs</a></li><li><a href="#outputs-2" class="table-of-contents__link toc-highlight">outputs</a></li><li><a href="#commands" class="table-of-contents__link toc-highlight">commands</a></li><li><a href="#scripts-1" class="table-of-contents__link toc-highlight">scripts</a></li></ul></li><li><a href="#the-cloudformation-grain" class="table-of-contents__link toc-highlight">The CloudFormation Grain​</a><ul><li><a href="#source-3" class="table-of-contents__link toc-highlight">source</a></li><li><a href="#host-3" class="table-of-contents__link toc-highlight">host</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">authentication</a></li><li><a href="#inputs-3" class="table-of-contents__link toc-highlight">inputs​</a></li><li><a href="#tags-1" class="table-of-contents__link toc-highlight">tags​</a></li><li><a href="#outputs-3" class="table-of-contents__link toc-highlight">outputs​</a></li></ul></li><li><a href="#the-kubernetes-grain" class="table-of-contents__link toc-highlight">The Kubernetes Grain​</a><ul><li><a href="#source-4" class="table-of-contents__link toc-highlight">source</a></li><li><a href="#host-4" class="table-of-contents__link toc-highlight">host</a></li><li><a href="#tags-2" class="table-of-contents__link toc-highlight">tags​</a></li><li><a href="#namespace" class="table-of-contents__link toc-highlight">namespace</a></li><li><a href="#scripts-outputs" class="table-of-contents__link toc-highlight">scripts (outputs)</a></li></ul></li><li><a href="#the-shell-grain" class="table-of-contents__link toc-highlight">The Shell Grain</a><ul><li><a href="#host-5" class="table-of-contents__link toc-highlight">host</a></li><li><a href="#inputs-4" class="table-of-contents__link toc-highlight">inputs</a></li><li><a href="#commands-1" class="table-of-contents__link toc-highlight">commands</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items"><li class="footer__item"><a href="https://www.quali.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Quali Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.quali.com/careers/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/QualiTorque/torque-docs/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/qualisystems" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.quali.com/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Quali blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.a453e321.js"></script>
<script src="/assets/js/main.6faeb22a.js"></script>
</body>
</html>