"use strict";(self.webpackChunktorque=self.webpackChunktorque||[]).push([["3599"],{8444:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>i,toc:()=>a,default:()=>u,metadata:()=>o,assets:()=>c,contentTitle:()=>l});var o=JSON.parse('{"id":"torque-agent/torque-docker-agent","title":"Torque Docker Agent","description":"How to install Torque Agent on a VM","source":"@site/docs/torque-agent/torque-docker-agent.md","sourceDirName":"torque-agent","slug":"/torque-agent/torque-docker-agent","permalink":"/torque-agent/torque-docker-agent","draft":false,"unlisted":false,"editUrl":"https://github.com/QualiTorque/torque-docs/tree/master/docs/torque-agent/torque-docker-agent.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Torque Docker Agent"},"sidebar":"defaultSidebar","previous":{"title":"Torque Agent on Azure VMSS","permalink":"/torque-agent/torque-agent-on-azure-vmss"},"next":{"title":"Changing advanced K8s settings","permalink":"/torque-agent/advanced-settings"}}'),s=t(4848),r=t(4429);let i={sidebar_position:6,title:"Torque Docker Agent"},l=void 0,c={},a=[{value:"How to install Torque Agent on a VM",id:"how-to-install-torque-agent-on-a-vm",level:2},{value:"Requirements",id:"requirements",level:3},{value:"What if my VM is barebone?",id:"what-if-my-vm-is-barebone",level:3},{value:"Install Torque agent",id:"install-torque-agent",level:3}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"how-to-install-torque-agent-on-a-vm",children:"How to install Torque Agent on a VM"}),"\n",(0,s.jsx)(n.p,{children:"Torque agent can be hosted in various ways, one of them on a VM/EC2 with a docker host installed."}),"\n",(0,s.jsx)(n.h3,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"VM (this guide will walk you through how to configure torque agent on ubuntu, but you can use any environment as long as it supports docker)"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"docker"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"docker-compose"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"wget"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"unzip"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"what-if-my-vm-is-barebone",children:"What if my VM is barebone?"}),"\n",(0,s.jsx)(n.p,{children:"Great question!\nFollow these steps to get your VM all set up."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.code,{children:"docker"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Add Docker\'s official GPG key:\nsudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyringsdocker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n\n# Add the repository to Apt sources:\necho \\\n  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\nsudo apt-get update\n\n# install docker and docker compose\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugindocker-compose-plugin\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create an executable to use docker compose as ",(0,s.jsx)(n.code,{children:"docker-compose"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat << 'EOF' | sudo tee /usr/local/bin/docker-compose\n#!/bin/bash\ndocker compose \"$@\"\nEOF\n\n# make it executable\nsudo chmod +x /usr/local/bin/docker-compose\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.code,{children:"wget"})," and ",(0,s.jsx)(n.code,{children:"unzip"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install wget unzip\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"install-torque-agent",children:"Install Torque agent"}),"\n",(0,s.jsx)(n.p,{children:"To install the agent, log in with as a system administrator"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Go-to ",(0,s.jsx)(n.a,{href:"https://portal.qtorque.io/admin/agents",children:"https://portal.qtorque.io/admin/agents"})]}),"\n",(0,s.jsxs)(n.li,{children:["Click on ",(0,s.jsx)(n.code,{children:"New Agent"}),", select the ",(0,s.jsx)(n.code,{children:"vCenter"})," logo, then choose ",(0,s.jsx)(n.code,{children:"Docker"}),". Choose a name for the agent and click on ",(0,s.jsx)(n.code,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Click on ",(0,s.jsx)(n.code,{children:"Generate"})]}),"\n",(0,s.jsxs)(n.li,{children:["Right click on it and select ",(0,s.jsx)(n.code,{children:"Copy Link"})]}),"\n",(0,s.jsxs)(n.li,{children:["SSH into your VM and execute the following","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wget <paste-the-copied-link> # for example wget https://portal.qtorque.io/api/settings/executionhosts/deployment/cYrzsDVgYSam/deployment.zip\nunzip deployment.zip\nsudo chmod +x deployment/deploy_agent.sh\nsudo chmod +x deployment/deploy_torque_agent.sh\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Install the agent by cd into ",(0,s.jsx)(n.code,{children:"deployment"})," folder and execute ",(0,s.jsx)(n.code,{children:"./deploy_torque_agent.sh"})]}),"\n",(0,s.jsxs)(n.li,{children:["Fill the agent name and press ",(0,s.jsx)(n.code,{children:"Enter"})]}),"\n",(0,s.jsx)(n.li,{children:"This will initiate the installation process. After roughly a minute you'll be able to see in Torque's portal the 'Connection Status' changes to 'Connected!'"}),"\n",(0,s.jsxs)(n.li,{children:["Click on ",(0,s.jsx)(n.code,{children:"Associate to Space"}),", choose the desired spaces and you're done!"]}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},4429:function(e,n,t){t.d(n,{R:()=>i,x:()=>l});var o=t(6540);let s={},r=o.createContext(s);function i(e){let n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);