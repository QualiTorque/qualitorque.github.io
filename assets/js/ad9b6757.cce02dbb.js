"use strict";(self.webpackChunktorque=self.webpackChunktorque||[]).push([[192],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return d}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=u(r),d=a,h=m["".concat(l,".").concat(d)]||m[d]||p[d]||o;return r?n.createElement(h,i(i({ref:t},c),{},{components:r})):n.createElement(h,i({ref:t},c))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var u=2;u<o;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},6293:function(e,t,r){r.r(t),r.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return p}});var n=r(7462),a=r(3366),o=(r(7294),r(3905)),i=["components"],s={sidebar_position:9,title:"Connect a Kubernetes Cluster"},l=void 0,u={unversionedId:"getting-started/Connect a Kubernetes Cluster",id:"getting-started/Connect a Kubernetes Cluster",title:"Connect a Kubernetes Cluster",description:"Kubernetes host architecture",source:"@site/docs/getting-started/Connect a Kubernetes Cluster.md",sourceDirName:"getting-started",slug:"/getting-started/Connect a Kubernetes Cluster",permalink:"/getting-started/Connect a Kubernetes Cluster",editUrl:"https://github.com/QualiTorque/torque-docs/tree/master/docs/getting-started/Connect a Kubernetes Cluster.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9,title:"Connect a Kubernetes Cluster"},sidebar:"torqueSidebar",previous:{title:"Connect an Execution Host",permalink:"/getting-started/Connect an Execution Host"},next:{title:"Launch Your Blueprint",permalink:"/getting-started/Launch-environment"}},c={},p=[{value:"Kubernetes host architecture",id:"kubernetes-host-architecture",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setup",id:"setup",level:2}],m={toc:p};function d(e){var t=e.components,s=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"kubernetes-host-architecture"},"Kubernetes host architecture"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"Locale Dropdown",src:r(3660).Z,width:"1152",height:"362"}))),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Kuberentes cluster"),(0,o.kt)("li",{parentName:"ul"},"Command-line connected to your cluster with ",(0,o.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tasks/tools/#kubectl"},"kubectl installed")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Namespace")," - A namespace on the cluster where the Torque agent will create resources.\n"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Authentication and permissions")," - The execution host will need sufficient permissions to create the environment's cloud resources. There are a couple of ways to provide the permissions, depending on where the environment resources will be created. ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"For Helm/kubernetes create a service account with sufficient permissions to create the K8s resources.\nExample:"),(0,o.kt)("li",{parentName:"ul"},"For Terraform:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"EKS")," (resources will be created on AWS):",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"(Recommended) Create a designated ",(0,o.kt)("strong",{parentName:"li"},"service account")," with the required permissions, and specify it in the blueprint. See ",(0,o.kt)("a",{parentName:"li",href:"/blueprint-designer-guide/service-accounts-for-aws"},"Terraform Authentication on EKS")," for details. Or,"),(0,o.kt)("li",{parentName:"ul"},"Ensure that the Cluster service role has sufficient permissions to create the environment. Or,"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"AKS")," (resources will be created on Azure): Provide the account's authentication credentials when creating the execution host in Torque. For details, see ",(0,o.kt)("a",{parentName:"li",href:"/blueprint-designer-guide/service-accounts-for-azure"},"Terraform Authentication on AKS"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"vCenter"),": For vCenter execution hosts, you will need to install Torque Agent on the cluster. When creating the vCenter execution host, Torque will provide you with the Torque Agent zip file, extract it to the cluster and run the ",(0,o.kt)("strong",{parentName:"li"},"deploy_torque_agent.sh")," file from the extracted.")))))),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"In Torque's ",(0,o.kt)("strong",{parentName:"li"},"Admin Console")," page, open the ",(0,o.kt)("strong",{parentName:"li"},"Cloud Accounts")," tab."),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Add Cloud Account")," and complete the wizard with the information you collected before. ",(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"Locale Dropdown",src:r(9805).Z,width:"842",height:"637"})))),(0,o.kt)("li",{parentName:"ol"},"Fill in the information and click ",(0,o.kt)("strong",{parentName:"li"},"Next"),". "),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Generate")," and copy the command that is displayed"),(0,o.kt)("li",{parentName:"ol"},"Paste the command in your command-line window to deploy the agent to your cluster. For example:     ",(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"title=",title:""},"kubectl apply -f https://portal.qtorque.io/api/settings/executionhosts/deployment/k***roi/deployment.yaml\n"))),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Check Connectivity")," to verify that the agent can sucessfully communicate with Torque. "),(0,o.kt)("li",{parentName:"ol"},"Once verified, click ",(0,o.kt)("strong",{parentName:"li"},"Finish")," in the window that pops up.")))}d.isMDXComponent=!0},9805:function(e,t,r){t.Z=r.p+"assets/images/add-k8s-wizard-d28fee2f76bad06ff3fe8338c848a880.png"},3660:function(e,t,r){t.Z=r.p+"assets/images/k8s-host-architecture-b5fde66cd9b57dffb3e35ca5a666af7e.png"}}]);