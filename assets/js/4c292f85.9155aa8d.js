"use strict";(self.webpackChunktorque=self.webpackChunktorque||[]).push([[2239],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>v});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=l(n),d=i,v=m["".concat(p,".").concat(d)]||m[d]||c[d]||o;return n?r.createElement(v,a(a({ref:t},u),{},{components:n})):r.createElement(v,a({ref:t},u))}));function v(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[m]="string"==typeof e?e:i,a[1]=s;for(var l=2;l<o;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3551:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(7462),i=(n(7294),n(3905));const o={sidebar_position:8,title:"Existing Environment Import"},a=void 0,s={unversionedId:"environment-services/Import",id:"environment-services/Import",title:"Existing Environment Import",description:"Import",source:"@site/docs/environment-services/Import.md",sourceDirName:"environment-services",slug:"/environment-services/Import",permalink:"/environment-services/Import",editUrl:"https://github.com/QualiTorque/torque-docs/tree/master/docs/environment-services/Import.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,title:"Existing Environment Import"},sidebar:"torqueSidebar",previous:{title:"Remote Access",permalink:"/environment-services/Remote access"},next:{title:"Environment Annotations",permalink:"/environment-services/environment-annotations"}},p={},l=[{value:"Import",id:"import",level:2},{value:"Import without a blueprint",id:"import-without-a-blueprint",level:3},{value:"Import using existing blueprint",id:"import-using-existing-blueprint",level:3},{value:"Limitations",id:"limitations",level:3},{value:"Release",id:"release",level:2}],u={toc:l},m="wrapper";function c(e){let{components:t,...n}=e;return(0,i.kt)(m,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"import"},"Import"),(0,i.kt)("p",null,"Torque lets you import your existing environments. Once the environment is imported it becomes a fully managed environment in Torque. This allows you to gain visibility of all the environments that were created outside of Torque and use Torque environment services like drift detection, updates, cost tracking & introspection with the imported environments."),(0,i.kt)("h3",{id:"import-without-a-blueprint"},"Import without a blueprint"),(0,i.kt)("p",null,"The import flow supports auto-generating a blueprint as part of the import request. This is useful in case you need to import an environment with a single grain and you don't have a corresponding blueprint yet. "),(0,i.kt)("p",null,"Example of a basic API request:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'curl -L \'https://portal.qtorque.io/api/spaces/<SPACE_NAME>/environments/import\' \\\n-H \'Authorization: Bearer <TOKEN>\' \\\n-H \'Content-Type: application/json\' \\\n-d \'{\n    "environment_name": "<ENV_NAME>",\n    "inputs": {        \n        "agent": "<AGENT_NAME>"\n        // additional inputs as needed\n    },\n    "grains": [\n        {\n            "kind": "terraform",          \n            "source": {\n                "store": "<REPO_NAME>",\n                "path": "<PATH_TO_TERRAFORM_MODULE>"\n            },\n            "credentials": ["<CLOUD_CREDENTIALS>"],\n            "backend": {\n                "type": "s3",  // s3|azurerm|gcs|http\n                "bucket": "<BUCKET_NAME>",\n                "region": "<REGION_NAME>",\n                "key": "<PATH_TO_TF_STATE_FILE>"\n            }\n        }\n    ]\n}\'\n')),(0,i.kt)("p",null,"Full API reference is available ",(0,i.kt)("a",{parentName:"p",href:"https://portal.qtorque.io/api_reference/#/paths/api-spaces-space_name--environments-import/post"},"here"),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"It's important to note that the backend section is mandatory and must reference a *.tfstate file in a supported backend (s3/azurerm/gcs/http). Also, the input values that are provided as part of the import request must be the same values that were used to provision the terraform module. If the input values do not match, Torque will detect a drift and fail the import.")),(0,i.kt)("h3",{id:"import-using-existing-blueprint"},"Import using existing blueprint"),(0,i.kt)("p",null,"The import feature also supports using an existing blueprint. It's useful in case where you need to import an environment with multiple grains or in case that you need to import multiple environments that were created from the same configurations. Full API reference is available ",(0,i.kt)("a",{parentName:"p",href:"https://portal.qtorque.io/api_reference/#/paths/api-spaces-space_name--environments-import_using_blueprint/post"},"here"),"."),(0,i.kt)("h3",{id:"limitations"},"Limitations"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Import is currently supported only for environments created with Terraform. "),(0,i.kt)("li",{parentName:"ul"},"The import flow with auto-generated blueprint supports only a single grain.")),(0,i.kt)("h2",{id:"release"},"Release"),(0,i.kt)("p",null,"The release flow allows to end a Torque environment without destroying the underlying resources. This feature is currently available only using an ",(0,i.kt)("a",{parentName:"p",href:"https://portal.qtorque.io/api_reference/#/paths/api-spaces-space_name--environments--environment_id--release/delete"},"API call"),"."))}c.isMDXComponent=!0}}]);