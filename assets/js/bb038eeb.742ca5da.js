"use strict";(self.webpackChunktorque=self.webpackChunktorque||[]).push([["2422"],{3421:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>o,toc:()=>d,default:()=>u,metadata:()=>s,assets:()=>a,contentTitle:()=>l});var s=JSON.parse('{"id":"governance/cost-tracking/configuring-cost-gcp","title":"Configuring Cost for GCP","description":"Prerequisites","source":"@site/docs/governance/cost-tracking/configuring-cost-gcp.md","sourceDirName":"governance/cost-tracking","slug":"/governance/cost-tracking/configuring-cost-gcp","permalink":"/governance/cost-tracking/configuring-cost-gcp","draft":false,"unlisted":false,"editUrl":"https://github.com/QualiTorque/torque-docs/tree/master/docs/governance/cost-tracking/configuring-cost-gcp.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"Configuring Cost for GCP"},"sidebar":"defaultSidebar","previous":{"title":"Configuring Cost for Azure","permalink":"/governance/cost-tracking/configuring-cost-azure"},"next":{"title":"Configuring Cost for K8s","permalink":"/governance/cost-tracking/configuring-cost-k8s"}}'),i=t(4848),r=t(4429);let c=t.p+"assets/images/gcp-cost-target-ebdc9228ac70faec9c311884d3b47ea9.png",o={sidebar_position:13,title:"Configuring Cost for GCP"},l=void 0,a={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Configuration Steps",id:"configuration-steps",level:2},{value:"Step 1: Set up BigQuery for Cost Data",id:"step-1-set-up-bigquery-for-cost-data",level:3},{value:"Step 2: Create a Service Account",id:"step-2-create-a-service-account",level:3},{value:"Step 3: Configure Torque",id:"step-3-configure-torque",level:3},{value:"Step 4: Enable the Cost Collection Target",id:"step-4-enable-the-cost-collection-target",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2}];function h(e){let n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure you have a GCP project with billing enabled."}),"\n",(0,i.jsx)(n.li,{children:"Create a BigQuery dataset and table to store detailed usage cost data."}),"\n",(0,i.jsxs)(n.li,{children:["Create a service account with the necessary permissions to access the BigQuery dataset and table. The service account must have the following roles:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"BigQuery Data Viewer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"BigQuery Job User"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Billing Account Viewer"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Download the service account key in JSON format. This will be used in Torque."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"configuration-steps",children:"Configuration Steps"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-set-up-bigquery-for-cost-data",children:"Step 1: Set up BigQuery for Cost Data"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["In your GCP Console, navigate to ",(0,i.jsx)(n.strong,{children:"BigQuery"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Create a dataset to store cost data:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create Dataset"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Enter a ",(0,i.jsx)(n.strong,{children:"Dataset ID"})," (e.g., ",(0,i.jsx)(n.code,{children:"cost_data"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Set the ",(0,i.jsx)(n.strong,{children:"Data location"})," and other settings as needed."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create Dataset"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Create a table for detailed usage cost data:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Select the dataset you just created."}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create Table"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Set the ",(0,i.jsx)(n.strong,{children:"Table ID"})," (e.g., ",(0,i.jsx)(n.code,{children:"detailed_usage_cost"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"Define the schema for the table based on your cost data requirements."}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create Table"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-a-service-account",children:"Step 2: Create a Service Account"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["In your GCP Console, navigate to ",(0,i.jsx)(n.strong,{children:"IAM & Admin > Service Accounts"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create Service Account"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Enter a ",(0,i.jsx)(n.strong,{children:"Service Account Name"})," (e.g., ",(0,i.jsx)(n.code,{children:"torque-cost-collector"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Assign the following roles to the service account:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"BigQuery Data Viewer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"BigQuery Job User"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Billing Account Viewer"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Download the service account key in JSON format:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Select the service account you just created."}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Keys > Add Key > Create New Key"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"JSON"})," and click ",(0,i.jsx)(n.strong,{children:"Create"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Save the JSON file securely."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-configure-torque",children:"Step 3: Configure Torque"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Administration > Cloud Accounts > Cost Collection Target"})," in Torque."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add Cost Collection Target"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"GCP"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Specify the following details:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Name"}),": A descriptive name for the cost collection target."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service Account Key JSON"}),": Upload the JSON file downloaded in Step 2."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Project ID"}),": The GCP project ID where the BigQuery dataset resides."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dataset Name"}),": The name of the BigQuery dataset (e.g., ",(0,i.jsx)(n.code,{children:"cost_data"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Detailed Usage Cost Table Name"}),": The name of the BigQuery table (e.g., ",(0,i.jsx)(n.code,{children:"detailed_usage_cost"}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Finish"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click the cost collection target's 3-dot menu and select ",(0,i.jsx)(n.strong,{children:"Validate"})," to ensure the configuration works."]}),"\n"]}),"\n","\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)("img",{src:c,alt:"gcp-cost-target",style:{width:800}}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-4-enable-the-cost-collection-target",children:"Step 4: Enable the Cost Collection Target"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Administration > Cloud Accounts > Cost Collection Target"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click the desired cost collection target's ",(0,i.jsx)(n.strong,{children:"Enabled"})," toggle."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.p,{children:"What can be done if you don't see cost in Torque's cost dashboard?"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure that cost data is being exported to the BigQuery table. Check the table in the GCP Console to verify data is present."}),"\n",(0,i.jsxs)(n.li,{children:["Validate the service account permissions:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure the service account has access to the BigQuery dataset and table."}),"\n",(0,i.jsxs)(n.li,{children:["Verify the service account has the ",(0,i.jsx)(n.code,{children:"Billing Account Viewer"})," role."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Test your credentials in Torque:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Administration > Cloud Accounts > Cost Collection Target > Choose your cloud > In the three-dot menu, click on Validate"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"If issues persist, review the configuration steps above and correct any errors."}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},4429:function(e,n,t){t.d(n,{R:()=>c,x:()=>o});var s=t(6540);let i={},r=s.createContext(i);function c(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);